"use strict";var reactiveNumber=angular.module("reactiveNumber",["reactiveController","ngRoute","ngAnimate","ngDialog"]);reactiveNumber.directive("backButton",function(){return{restrict:"A",link:function(e,t){function r(){history.back(),e.$apply()}t.bind("click",r)}}}),reactiveNumber.config(["$routeProvider",function(e){e.when("/high-score",{templateUrl:"html/_high-score.html",controller:"HighScore"}).when("/how-to",{templateUrl:"html/_how-to.html",controller:"HowTo"}).when("/game/:command",{templateUrl:"html/_game.html",controller:"Game"}).when("/about",{templateUrl:"html/_about.html",controller:"About"}).otherwise({redirectTo:"/game/continue"})}]),reactiveNumber.directive("animateOnChange",["$animate",function(e){return function(t,r,n){t.$watch(n.animateOnChange,function(t,n){if(t!=n){var o="change";e.addClass(r,o).then(function(){e.removeClass(r,o)})}})}}]),reactiveNumber.directive("animateOnIncrease",["$animate",function(e){return function(t,r,n){t.$watch(n.animateOnChange,function(t,n){if(t>n){var o="change";e.addClass(r,o).then(function(){e.removeClass(r,o)})}})}}]),reactiveNumber.directive("animateBoard",["$animate","$timeout",function(e){return function(t,r,n){t.$watch(n.animateBoard,function(t,n){var o="";t!=n&&(o=t>n?"changeup":"changedown",0==t&&(o="changezero"),0==n&&0!=t&&(o="changeadd"),e.addClass(r.children(),o).then(function(){e.removeClass(r.children(),o)}))})}}]),reactiveNumber.service("scoreService",function(){function e(e){var t=e.score,r=e.level,n=e.date,o=e.max_combo,i=e.turn;return Math.ceil(t*r/n.getHours()+n.getMilliseconds()/4+o/i)}function t(){var e=localStorage.getItem(n(o));return void 0!=e?JSON.parse(n(e)):void 0}function r(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(r,n){var o=r[e]<n[e]?-1:r[e]>n[e]?1:0;return o*t}}function n(e){var t="",r=c.match;for(i=0;i<e.length;i++)t+=String.fromCharCode(r^e.charCodeAt(i));return t}var o="hs",a=20;this.saveHighScore=function(i){var a=t();void 0==a&&(a=[]),i.scores=e(i),a.push(i),a.sort(r("-score")),a.length>100&&a.pop(),localStorage.setItem(n(o),n(JSON.stringify(a)))},this.getPageCount=function(){var e=t();return void 0==e?0:Math.ceil(e.length/a)},this.getList=function(e,n){var o=t();return void 0==o?void 0:(o.sort(r(e)),o=o.slice((n-1)*a,(n-1)*a+20))},this.getHighestScore=function(){var e=t();return void 0==e?e:(e.sort(r("-score")),e.shift())}}),reactiveNumber.config(["$animateProvider",function(e){e.classNameFilter(/^((?!(bar-fill)).)*$/)}]),reactiveNumber.run(["$rootScope",function(e){e.$on("$routeChangeStart",function(){console.log("progress start")}),e.$on("$routeChangeSuccess",function(){console.log("progress complete")}),e.$on("$routeChangeError",function(){console.log("progress error")})}]);
