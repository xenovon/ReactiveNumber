"use strict";var reactiveNumber=angular.module("reactiveNumber",["reactiveController","ngRoute","ngAnimate","ngDialog"]);reactiveNumber.directive("backButton",function(){return{restrict:"A",link:function(e,t){function n(){history.back(),e.$apply()}t.bind("click",n)}}}),reactiveNumber.config(["$routeProvider",function(e){e.when("/high-score",{templateUrl:"html/_high-score.html",controller:"HighScore"}).when("/how-to",{templateUrl:"html/_how-to.html",controller:"HowTo"}).when("/game/:command",{templateUrl:"html/_game.html",controller:"Game"}).when("/about",{templateUrl:"html/_about.html",controller:"About"}).otherwise({redirectTo:"/game/continue"})}]),reactiveNumber.directive("animateOnChange",["$animate",function(e){return function(t,n,r){t.$watch(r.animateOnChange,function(t,r){if(t!=r){var i="change";e.addClass(n,i).then(function(){e.removeClass(n,i)})}})}}]),reactiveNumber.directive("animateOnIncrease",["$animate",function(e){return function(t,n,r){t.$watch(r.animateOnChange,function(t,r){if(t>r){var i="change";e.addClass(n,i).then(function(){e.removeClass(n,i)})}})}}]),reactiveNumber.directive("animateBoard",["$animate","$timeout",function(e){return function(t,n,r){t.$watch(r.animateBoard,function(t,r){var i="";t!=r&&(i=t>r?"changeup":"changedown",0==t&&(i="changezero"),0==r&&0!=t&&(i="changeadd"),e.addClass(n.children(),i).then(function(){e.removeClass(n.children(),i)}))})}}]),reactiveNumber.service("scoreService",function(){function e(e){var t=e.score,n=e.level,r=e.date,i=e.max_combo,o=e.turn;return Math.ceil(t*n/r.getHours()+r.getMilliseconds()/4+i/o)}function t(){var e=localStorage.getItem(r(o));return void 0!=e?JSON.parse(r(e)):void 0}function n(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(n,r){var i=n[e]<r[e]?-1:n[e]>r[e]?1:0;return i*t}}function r(e){var t="",n=c.match;for(i=0;i<e.length;i++)t+=String.fromCharCode(n^e.charCodeAt(i));return t}var o="hs",a=20;this.saveHighScore=function(i){var a=t();void 0==a&&(a=[]),i.scores=e(i),a.push(i),a.sort(n("-score")),a.length>100&&a.pop(),localStorage.setItem(r(o),r(JSON.stringify(a)))},this.getPageCount=function(){var e=t();return void 0==e?0:Math.ceil(e.length/a)},this.getList=function(e,r){var i=t();return void 0==i?void 0:(i.sort(n(e)),i=i.slice((r-1)*a,(r-1)*a+20))},this.getHighestScore=function(){var e=t();return void 0==e?e:(e.sort(n("-score")),e.shift())}}),reactiveNumber.config(["$animateProvider",function(e){e.classNameFilter(/^((?!(bar-fill)).)*$/)}]),reactiveNumber.run(["$rootScope",function(e){e.$on("$routeChangeStart",function(){e.loadingView="show"}),e.$on("$routeChangeSuccess",function(){e.loadingView=""}),e.$on("$routeChangeError",function(){e.loadingView=""})}]);
