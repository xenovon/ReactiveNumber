"use strict";var reactiveController=angular.module("reactiveController",[]),modalInstance;reactiveController.controller("GlobalCtrl",["$scope","$route","$location","scoreService","$rootScope",function(e,t,a,o,n){e.gameParent=new Game,n.loadingView="",e.newGame=function(){e.gameParent.newGame(),a.url("/game/new"),e.$broadcast("updateState","")},e.newGameAndHideMenu=function(){e.newGame(),e.isMenuActive=!e.isMenuActive},e.$on("newGame",function(){e.newGame()}),e.$on("hideMenu",function(){e.isMenuActive=!1}),e.$on("gameOver",function(){var t=e.gameParent.getGameData(),a=0!=t.combo.length?Math.max.apply(Math,t.combo):0;void 0==a&&(a=0),o.saveHighScore({score:t.score,date:new Date,level:t.level.current,max_combo:a,turn:t.turn.turnCount})})}]),reactiveController.controller("Game",["$scope","$routeParams","$location","$animate","ngDialog","$timeout",function(e,t,a,o,n,r){function i(){if(e.$emit("hideMenu"),void 0!=e.game.getGameData()){e.uiState.multipolar=e.game.getGameData().bonus.multipolar.isActive?"active shake shake-constant":"shake",e.uiState.bomb=e.game.getGameData().bonus.bomb.isActive?"active shake":"shake",e.uiState.currentTurn=e.game.getGameData().bonus.bomb.isActive?"shake shake-constant":"";var t=e.game.getGameData().level.totalThisLevel,a=e.game.getGameData().level.toGo,o=e.uiState.barSize,n=e.uiState.barSizeAnimate,r=e.game.getEmptyBlockMap();if(0==t)o=0;else{n=a==t?"no-anim":"anim";var i=t-a;o=Math.round((i*t+i)/t/t*100),99==o?o="100%":o+="%"}e.game.isGameOver()?(e.uiState.blockClass="gameOver",e.$emit("gameOver"),c()):r.length<=4?e.uiState.blockClass="shake shake-little shake-constant":1==r.length?(e.uiState.blockClass="shake shake-little shake-constant",e.uiState.blockClass="shake shake-constant"):e.uiState.blockClass="",e.game.getGameData().bonus.multipolar.isActive&&(e.uiState.blockClass+=e.game.getGameData().turnValue[0]%2==0?" even-m":" odd-m"),e.game.getGameData().bonus.bomb.isActive&&(e.uiState.blockClass+="shake shake-hover"),e.uiState.barSizeAnimate=n,e.uiState.barSize=o}}function c(){n.open({template:"html/_dialog-gameover.html",scope:e})}e.command=t.command,e.game=e.$parent.gameParent,e.uiState={multipolar:"",bomb:"",barSize:"",barSizeAnimate:"anim",blockClass:"",currentTurn:""},e.currentLevel=0,e.score=0,e.jValue,"continue"==e.command&&(e.game.continueGame(),i("continue")),"new"==e.command&&void 0==e.game.getGameData()&&(e.game.newGame(),i("new")),i("Main"),e.multipolar=function(){e.game.bonus("multipolar"),i("multipolar")},e.undo=function(){e.game.undo(),i("undo")},e.bomb=function(){e.game.bonus("bomb"),i("bomb")},e.mouseOver=function(t){0==t&&(t=e.uiState.currentTurn)},e.turn=function(t,a){var o=e.game.turn(t,a);0==o.error.length&&r(function(){e.game.popOutTurn(),i("turn")},500)},e.openDialog=function(){n.open({template:"html/_dialog-gameover.html",scope:e})},e.getOddEvenStyle=function(t){var a;return 0==t?(a=e.game.getGameData().turnValue[0]%2==0?"even number-hide":"odd number-hide",a+=e.game.getGameData().turnValue[0]>999?" font-small":""):(a=t%2==0?"even":"odd",a+=t>999?" font-small":""),a},e.$on("updateState",function(){i("broadcast")})}]),reactiveController.controller("About",["$scope",function(){}]),reactiveController.controller("HighScore",["$scope","scoreService",function(e,t){e.isHaveScore=0==t.getPageCount()?!1:!0,e.scoreList=[],e.highscore=t.getHighestScore(),e.pageCount=0,e.sortBy="",e.page=1,e.isDesc=!0,e.setList=function(a,o){var n="";void 0==a&&(a=e.sortBy),void 0==o&&(o=e.page),n=e.isDesc?"-":"",e.scoreList=t.getList(n+a,o),e.sortBy=a,e.page=o},e.sort=function(t){t==e.sortBy&&(e.isDesc=!e.isDesc),e.setList(t,e.page)},e.setPageCount=function(){e.pageCount=t.getPageCount()},e.setPageCount(),e.setList("-score",1),e.next=function(){e.page!=t.getPageCount()&&(e.page=e.page+1),e.setList(void 0,void 0)},e.prev=function(){1!=e.page&&(e.page=e.page-1),e.setList(void 0,void 0)}}]),reactiveController.controller("Home",["$scope",function(){}]),reactiveController.controller("HowTo",["$scope","$http",function(e){e.langId="hide",e.langEng="show",e.changeLang=function(t){"id"==t?(e.langId="show",e.langEng="hide"):"en"==t&&(e.langId="hide",e.langEng="show")}}]),reactiveController.controller("GameOver",["$scope","scoreService",function(e,t){function a(){var t=e.gameData;return t.score!=e.highScore_score?!1:t.turn.turnCount!=e.highScore_turn?!1:t.level.current!=e.highScore_level?!1:e.maxCombo()!=e.highScore_maxCombo?!1:!0}function o(){var a=t.getHighestScore();void 0==a?e.haveHighScore=!1:(e.haveHighScore=!0,e.highScore_score=a.score,e.highScore_maxCombo=a.max_combo,e.highScore_turn=a.turn,e.highScore_level=a.level,e.highScore_date=a.date)}e.gameData=e.$parent.$parent.game.getGameData(),e.newGame=function(){e.$emit("newGame"),e.closeThisDialog()},e.maxCombo=function(){return 0!=e.gameData.combo.length?Math.max.apply(Math,e.gameData.combo):0},e.getMotivationalText=function(){var t=e.gameData.score;return o(),a()?"New Highscore, Stunning!":1e3>t?"Don't Worry, You can get higher":t>=1e3&&5e3>t?"Good Job, you're doing great":t>=5e3&&1e4>t?"Fantastic, Keep it up!":t>=1e4&&2e4>t?"You're Amazing! Congrats":t>=2e4?"It's Unbelievable! You're Extraordinary":"Keep it up!"},e.saveScore=function(){},e.haveHighScore=!0,e.highScore_score=0,e.highScore_maxCombo=0,e.highScore_turn=0,e.highScore_level=0,e.highScore_date=0}]);
