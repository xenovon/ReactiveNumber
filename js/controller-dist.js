"use strict";var reactiveController=angular.module("reactiveController",[]),modalInstance;reactiveController.controller("GlobalCtrl",["$scope","$route","$location",function(e,a,t){e.gameParent=new Game,e.newGame=function(){e.gameParent.newGame(),t.url("/game/new"),e.$broadcast("updateState","")},e.$on("newGame",function(){e.newGame()})}]),reactiveController.controller("Game",["$scope","$routeParams","$location","$animate","ngDialog","$timeout",function(e,a,t,o,n,l){function m(a){if(console.log("caller"+a),void 0!=e.game.getGameData()){e.uiState.multipolar=e.game.getGameData().bonus.multipolar.isActive?"active shake shake-constant":"shake",e.uiState.bomb=e.game.getGameData().bonus.bomb.isActive?"active shake":"shake",e.uiState.currentTurn=e.game.getGameData().bonus.bomb.isActive?"shake shake-constant":"";var t=e.game.getGameData().level.totalThisLevel,o=e.game.getGameData().level.toGo,n=e.uiState.barSize,l=e.uiState.barSizeAnimate,m=e.game.getEmptyBlockMap();if(0==t)n=0;else{l=o==t?"no-anim":"anim";var i=t-o;n=Math.round((i*t+i)/t/t*100),99==n?n="100%":n+="%"}e.game.isGameOver()?(e.uiState.blockClass="gameOver",r()):m.length<=4?e.uiState.blockClass="shake shake-little shake-constant":1==m.length?(e.uiState.blockClass="shake shake-little shake-constant",e.uiState.blockClass="shake shake-constant"):e.uiState.blockClass="",e.game.getGameData().bonus.multipolar.isActive&&(e.uiState.blockClass+=e.game.getGameData().turnValue[0]%2==0?" even-m":" odd-m"),e.game.getGameData().bonus.bomb.isActive&&(e.uiState.blockClass+="shake shake-hover"),e.uiState.barSizeAnimate=l,e.uiState.barSize=n}}function r(){n.open({template:"html/_dialog-gameover.html",scope:e})}e.command=a.command,e.game=e.$parent.gameParent,e.uiState={multipolar:"",bomb:"",barSize:"",barSizeAnimate:"anim",blockClass:"",currentTurn:""},e.currentLevel=0,e.score=0,"continue"==e.command&&(e.game.continueGame(),m("continue")),"new"==e.command&&void 0==e.game.getGameData()&&(e.game.newGame(),m("new")),m("Main"),e.multipolar=function(){e.game.bonus("multipolar"),m("multipolar")},e.undo=function(){e.game.undo(),m("undo")},e.bomb=function(){e.game.bonus("bomb"),m("bomb")},e.turn=function(a,t){var o=e.game.turn(a,t);0==o.error.length&&l(function(){e.game.popOutTurn(),m("turn")},500)},e.openDialog=function(){n.open({template:"html/_dialog-gameover.html",scope:e})},e.getOddEvenStyle=function(a){var t;return 0==a?(t=e.game.getGameData().turnValue[0]%2==0?"even number-hide":"odd number-hide",t+=e.game.getGameData().turnValue[0]>999?" font-small":""):(t=a%2==0?"even":"odd",t+=a>999?" font-small":""),t},e.$on("updateState",function(){m("broadcast")})}]),reactiveController.controller("About",["$scope",function(){}]),reactiveController.controller("HighScore",["$scope",function(){}]),reactiveController.controller("Home",["$scope",function(){}]),reactiveController.controller("HowTo",["$scope","$http",function(){}]),reactiveController.controller("GameOver",["$scope",function(e){e.gameData=e.$parent.$parent.game.getGameData(),console.log(e.gameData),e.newGame=function(){e.$emit("newGame"),e.closeThisDialog()},e.maxCombo=function(){return 0!=e.gameData.combo.length?Math.max.apply(Math,e.gameData.combo):0}}]);
